[
  {
    "timestamp": "2025-07-24T05:47:12.664523",
    "role": "user",
    "content": "Please provide only the final Java code solution as one code block suitable for submission, without additional commentary."
  },
  {
    "timestamp": "2025-07-24T05:48:06.430084",
    "role": "assistant",
    "content": "```java\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n    static int gcd(int a, int b) {\n        while (b != 0) {\n            int t = a % b;\n            a = b;\n            b = t;\n        }\n        return a;\n    }\n    public static void main(String[] args) throws IOException {\n        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));\n        PrintWriter out = new PrintWriter(System.out);\n        int t = Integer.parseInt(in.readLine().trim());\n        while (t-- > 0) {\n            StringTokenizer st = new StringTokenizer(in.readLine());\n            int n = Integer.parseInt(st.nextToken());\n            int m = Integer.parseInt(st.nextToken());\n            int k = Integer.parseInt(st.nextToken());\n            long[][] a = new long[n+1][m+1];\n            for (int i = 1; i <= n; i++) {\n                st = new StringTokenizer(in.readLine());\n                for (int j = 1; j <= m; j++) {\n                    a[i][j] = Long.parseLong(st.nextToken());\n                }\n            }\n            int[][] w = new int[n+1][m+1];\n            for (int i = 1; i <= n; i++) {\n                String s = in.readLine();\n                for (int j = 1; j <= m; j++) {\n                    w[i][j] = (s.charAt(j-1) == '0') ? +1 : -1;\n                }\n            }\n            long D = 0;\n            for (int i = 1; i <= n; i++) {\n                for (int j = 1; j <= m; j++) {\n                    D += w[i][j] * a[i][j];\n                }\n            }\n            int[][] pref = new int[n+1][m+1];\n            for (int i = 1; i <= n; i++) {\n                for (int j = 1; j <= m; j++) {\n                    pref[i][j] = w[i][j] + pref[i-1][j] + pref[i][j-1] - pref[i-1][j-1];\n                }\n            }\n            int g = 0;\n            for (int u = 1; u + k - 1 <= n; u++) {\n                for (int v = 1; v + k - 1 <= m; v++) {\n                    int i2 = u + k - 1;\n                    int j2 = v + k - 1;\n                    int blockSum = pref[i2][j2] - pref[u-1][j2] - pref[i2][v-1] + pref[u-1][v-1];\n                    g = gcd(g, Math.abs(blockSum));\n                }\n            }\n            if (g == 0) {\n                out.println(D == 0 ? \"YES\" : \"NO\");\n            } else {\n                out.println((D % g) == 0 ? \"YES\" : \"NO\");\n            }\n        }\n        out.flush();\n    }\n}\n```"
  }
]