[
  {
    "timestamp": "2025-07-24T05:54:20.659871",
    "role": "user",
    "content": "Please provide only the final Java solution in one self-contained code block (with class Main and all necessary imports), and do not include any additional explanation."
  },
  {
    "timestamp": "2025-07-24T05:56:21.723535",
    "role": "assistant",
    "content": "```java\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n        PrintWriter out = new PrintWriter(System.out);\n        int t = Integer.parseInt(br.readLine().trim());\n        while (t-- > 0) {\n            String s = br.readLine();\n            int n = s.length();\n            List<Character> U = new ArrayList<>();\n            List<Integer> cList = new ArrayList<>();\n            int run = 0;\n            for (int i = 0; i < n; i++) {\n                char ch = s.charAt(i);\n                if (ch == 'a') {\n                    run++;\n                } else {\n                    cList.add(run);\n                    run = 0;\n                    U.add(ch);\n                }\n            }\n            cList.add(run);\n            int k = U.size();\n            if (k == 0) {\n                out.println(n - 1);\n                continue;\n            }\n            char[] up = new char[k];\n            for (int i = 0; i < k; i++) up[i] = U.get(i);\n            int[] c = new int[k + 1];\n            for (int i = 0; i <= k; i++) c[i] = cList.get(i);\n            List<Integer> divisors = new ArrayList<>();\n            for (int d = 1; d * d <= k; d++) {\n                if (k % d == 0) {\n                    divisors.add(d);\n                    if (d != k / d) divisors.add(k / d);\n                }\n            }\n            long ans = 0;\n            for (int r : divisors) {\n                int m = k / r;\n                boolean ok = true;\n                for (int i = 0; i + r < k; i++) {\n                    if (up[i] != up[i + r]) {\n                        ok = false;\n                        break;\n                    }\n                }\n                if (!ok) continue;\n                for (int i = 1; i + r < k; i++) {\n                    if (c[i] != c[i + r]) {\n                        ok = false;\n                        break;\n                    }\n                }\n                if (!ok) continue;\n                int y0max = Integer.MAX_VALUE;\n                for (int j = 0; j < m; j++) {\n                    y0max = Math.min(y0max, c[j * r]);\n                }\n                int yEmax = Integer.MAX_VALUE;\n                for (int j = 1; j <= m; j++) {\n                    yEmax = Math.min(yEmax, c[j * r]);\n                }\n                ans += (long)(y0max + 1) * (yEmax + 1);\n            }\n            out.println(ans);\n        }\n        out.flush();\n    }\n}\n```"
  }
]