G. Yasya and the Mysterious Tree
time limit per test2.5 seconds
memory limit per test512 megabytes
Yasya was walking in the forest and accidentally found a tree with n
 vertices. A tree is a connected undirected graph with no cycles.

Next to the tree, the girl found an ancient manuscript with m
 queries written on it. The queries can be of two types.

The first type of query is described by the integer y
. The weight of each edge in the tree is replaced by the bitwise exclusive OR of the weight of that edge and the integer y
.

The second type is described by the vertex v
 and the integer x
. Yasya chooses a vertex u
 (1≤u≤n
, u≠v
) and mentally draws a bidirectional edge of weight x
 from v
 to u
 in the tree.

Then Yasya finds a simple cycle in the resulting graph and calculates the bitwise exclusive OR of all the edges in it. She wants to choose a vertex u
 such that the calculated value is maximum. This calculated value will be the answer to the query. It can be shown that such a cycle exists and is unique under the given constraints (independent of the choice of u
). If an edge between v
 and u
 already existed, a simple cycle is the path v→u→v
.

Note that the second type of query is performed mentally, meaning the tree does not change in any way after it.

Help Yasya answer all the queries.

Input
The first line contains an integer t
 (1≤t≤104
) — the number of test cases.

The descriptions of the test cases follow.

The first line of each test case contains two integers n
, m
 (2≤n≤2⋅105
, 1≤m≤2⋅105
) — the number of vertices in the tree and the number of queries.

The next n−1
 lines of each test case contain three integers v
, u
, w
 (1≤v,u≤n
, 1≤w≤109
) — the ends of some edge in the tree and its weight.

It is guaranteed that the given set of edges forms a tree.

The next m
 lines of each test case describe the queries:

^ y
 (1≤y≤109
) — parameter of the first type query;
? v
 x
 (1≤v≤n
, 1≤x≤109
) — parameters of the second type query.
It is guaranteed that the sum of n
 over all test cases does not exceed 2⋅105
. The same is guaranteed for m
.

Output
For each test case, output the answers to the queries of the second type.

Examples
InputCopy
2
3 7
1 2 1
3 1 8
^ 5
? 2 9
^ 1
? 1 10
^ 6
? 3 1
? 2 9
5 6
1 2 777
3 2 2812
4 1 16
5 3 1000000000
^ 4
? 3 123
? 5 1000000000
^ 1000000000
? 1 908070
? 2 1
OutputCopy
13 15 11 10 
1000000127 2812 999756331 999999756 
InputCopy
3
8 4
8 6 3
6 3 4
2 5 4
7 6 2
7 1 10
4 1 4
5 1 2
^ 4
^ 7
? 7 8
? 4 10
5 6
3 1 4
2 3 9
4 3 6
5 2 10
? 5 7
^ 1
^ 8
? 4 10
? 1 9
? 3 6
4 2
2 1 4
4 3 5
2 3 4
^ 13
? 1 10
OutputCopy
14 13 
13 8 11 11 
10 